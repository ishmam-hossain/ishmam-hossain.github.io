<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Pivoting a Multi-Index Pandas DataFrame - Ishmam Hossain</title><link rel=icon type=image/png href=https://img.icons8.com/officel/16/000000/chevron-right.png><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to Pivot a Dataframe"><meta property="og:image" content="https://raw.githubusercontent.com/athul/archie/master/images/archie-dark.png"><meta property="og:title" content="Pivoting a Multi-Index Pandas DataFrame"><meta property="og:description" content="How to Pivot a Dataframe"><meta property="og:type" content="article"><meta property="og:url" content="https://ishmam-hossain.github.io/posts/pivoting-a-multi-index-pandas-dataframe/"><meta property="article:published_time" content="2023-02-24T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-24T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pivoting a Multi-Index Pandas DataFrame"><meta name=twitter:description content="How to Pivot a Dataframe"><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://ishmam-hossain.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://ishmam-hossain.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css disabled></head><body><div class=content><header><div class=main><a href=https://ishmam-hossain.github.io/>Ishmam Hossain</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a>
| <span id=dark-mode-toggle onclick=toggleTheme()></span><script src=https://ishmam-hossain.github.io/js/themetoggle.js></script></nav></header><main><article><div class=title><h1 class=title>Pivoting a Multi-Index Pandas DataFrame</h1><div class=meta>Posted on Feb 24, 2023</div></div><section class=body><p>Pandas is a popular Python library for data analysis and manipulation. It provides a powerful data structure called the DataFrame, which is similar to a table in a relational database. DataFrames can have multiple levels of index, which can make them challenging to work with. In this blog post, we&rsquo;ll show you how to pivot a multi-index Pandas DataFrame to create a new DataFrame with columns and rows.</p><p>Suppose we have a Pandas DataFrame that looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>                                   Cases
Category Country                       
Confirmed Afghanistan           <span style=color:#ae81ff>209451</span>
          Albania               <span style=color:#ae81ff>334457</span>
          Algeria               <span style=color:#ae81ff>271496</span>
          Andorra                <span style=color:#ae81ff>47890</span>
          Angola                <span style=color:#ae81ff>105288</span>
          <span style=color:#f92672>...</span>                      <span style=color:#f92672>...</span>
Death     West Bank <span style=color:#f92672>and</span> Gaza      <span style=color:#ae81ff>5708</span>
          Yemen                   <span style=color:#ae81ff>2159</span>
          Zambia                  <span style=color:#ae81ff>4057</span>
          Zimbabwe                <span style=color:#ae81ff>5671</span>

[<span style=color:#ae81ff>603</span> rows x <span style=color:#ae81ff>1</span> columns]
</code></pre></div><p>This DataFrame has a multi-level index, with the first level corresponding to the &ldquo;Category&rdquo; (either &ldquo;Confirmed&rdquo; or &ldquo;Death&rdquo;) and the second level corresponding to the country name. The DataFrame has only one column with the total number of confirmed or deaths cases for each country.</p><p>Suppose we want to create a new DataFrame with the &ldquo;Death&rdquo; and &ldquo;Confirmed&rdquo; categories as columns and the country names as rows. To do this, we need to pivot the DataFrame so that the first level of the index becomes the columns and the second level becomes the rows.</p><p>We can use the .unstack() method to pivot the DataFrame. The .unstack() method pivots the DataFrame based on the specified level(s) of the index. In this case, we want to pivot the DataFrame based on the first level of the index (i.e., the &ldquo;Category&rdquo; level), so we&rsquo;ll pass level=0 to the .unstack() method.</p><p>Here&rsquo;s the code to pivot the DataFrame:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>new_df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>unstack(level<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)[<span style=color:#e6db74>&#39;Value&#39;</span>]
</code></pre></div><p>The resulting DataFrame looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>                       Death  Confirmed
Afghanistan             <span style=color:#ae81ff>5793</span>     <span style=color:#ae81ff>209451</span>
Albania                 <span style=color:#ae81ff>7591</span>     <span style=color:#ae81ff>334457</span>
Algeria                 <span style=color:#ae81ff>7534</span>     <span style=color:#ae81ff>271496</span>
Andorra                  <span style=color:#ae81ff>652</span>      <span style=color:#ae81ff>47890</span>
Angola                  <span style=color:#ae81ff>2757</span>     <span style=color:#ae81ff>105288</span>
<span style=color:#f92672>...</span>                      <span style=color:#f92672>...</span>        <span style=color:#f92672>...</span>
West Bank <span style=color:#f92672>and</span> Gaza      <span style=color:#ae81ff>5708</span>     <span style=color:#ae81ff>307127</span>
Yemen                   <span style=color:#ae81ff>2159</span>       <span style=color:#ae81ff>8829</span>
Zambia                  <span style=color:#ae81ff>4057</span>     <span style=color:#ae81ff>114209</span>
Zimbabwe                <span style=color:#ae81ff>5671</span>     <span style=color:#ae81ff>128940</span>

[<span style=color:#ae81ff>201</span> rows x <span style=color:#ae81ff>2</span> columns]
</code></pre></div><p>In this new DataFrame, the index consists of the country names, and there are only 201 rows (one for each country). The &ldquo;Death&rdquo; and &ldquo;Confirmed&rdquo; categories are now columns in the DataFrame.</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/code>Code</a></li><li><a href=/tags/pandas>Pandas</a></li><li><a href=/tags/python>Python</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=mailto:mailto:ishmam.dev@gmail.com rel=me title=Email><i data-feather=inbox></i></a><a class=border></a><a class=soc href=https://github.com/ishmam-hossain rel=me title=GitHub><i data-feather=github></i></a><a class=border></a><a class=soc href=https://linkedin.com/in/ishmam-hossain rel=me title=Linkedin><i data-feather=linkedin></i></a><a class=border></a><a class=soc href=https://stackoverflow.com/users/9907570/ishmam rel=me title="Stack OverFlow"><i data-feather=layers></i></a><a class=border></a><a class=soc href=https://leetcode.com/ishmamhossain/ rel=me title=Leetcode><i data-feather=terminal></i></a><a class=border></a></div><div class=footer-info>2023 Â©ishmam.dev@gmail.com | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>